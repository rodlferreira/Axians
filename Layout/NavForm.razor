@page "/taxas"

<div class="container">

    <div class="sidebar">
        <ul class="option-list">
            <li class="option completed">Op√ß√£o 1 <img aria-hidden="true" src="images/Pizza-Chart.png"
                    asp-append-version="true" alt="" width="24px" height="24px"></li>
            <li class="option completed">Op√ß√£o 2 <img aria-hidden="true" src="images/Pizza-Chart.png"
                    asp-append-version="true" alt="" width="24px" height="24px"></li>
            <li class="option completed">Op√ß√£o 3 <img aria-hidden="true" src="images/Pizza-Chart.png"
                    asp-append-version="true" alt="" width="24px" height="24px"></li>
            <li class="option completed">Op√ß√£o 4 <img aria-hidden="true" src="images/Pizza-Chart.png"
                    asp-append-version="true" alt="" width="24px" height="24px"></li>
            <li class="option completed">Op√ß√£o 5 <img aria-hidden="true" src="images/Pizza-Chart.png"
                    asp-append-version="true" alt="" width="24px" height="24px"></li>
            <li class="option completed">Op√ß√£o 6 <img aria-hidden="true" src="images/Pizza-Chart.png"
                    asp-append-version="true" alt="" width="24px" height="24px"></li>
            <li class="option completed">Op√ß√£o 7 <img aria-hidden="true" src="images/Pizza-Chart.png"
                    asp-append-version="true" alt="" width="24px" height="24px"></li>
            <li class="option completed">Op√ß√£o 8 <img aria-hidden="true" src="images/Pizza-Chart.png"
                    asp-append-version="true" alt="" width="24px" height="24px"></li>
            <li class="option completed">Op√ß√£o 9 <img aria-hidden="true" src="images/Pizza-Chart.png"
                    asp-append-version="true" alt="" width="24px" height="24px"></li>
            <li class="option selected">Op√ß√£o 10 <span class="status loading">&#9711;</span></li>
            <li class="option">Op√ß√£o 11 <span class="status">&#9711;</span></li>
            <li class="option">Op√ß√£o 12 <span class="status">&#9711;</span></li>
        </ul>
    </div>


    <div class="main-content">
        <div class="header">
            <h1>Op√ß√£o 10</h1>
            <p class="required">* Campos de preenchimento obrigat√≥rio</p>
        </div>

        <div class="form-section">
            <h2>Tipo de taxa</h2>
            <label for="taxa-select">Adicionar tipo de taxa</label>
            <select id="taxa-select">
                <option>Selecionar</option>
            </select>
        </div>

        <div class="form-section">
            <h2>Contar *</h2>
            <label><input type="radio" name="contar" value="sim"> Sim</label>
            <label><input type="radio" name="contar" value="nao"> N√£o</label>
        </div>

        <div class="form-section">
            <h2>Taxa *</h2>
            <label><input type="checkbox" /> Adicionar taxa por localiza√ß√£o</label>
            <table class="tax-table">
                <thead>
                    <tr>
                        <th><input type="checkbox"></th>
                        <th>NUTS II</th>
                        <th>NUTS III</th>
                        <th>Concelho</th>
                        <th>Taxa (%)</th>
                        <th>A√ß√£o</th>
                    </tr>
                </thead>
                <tbody>
                    @foreach (var taxa in taxItems)
                    {
                        <tr>
                            <td><input type="checkbox" @onchange="(e) => ToggleCheckbox(taxa, e.Value as bool?)"
                                    checked="@taxa.Selected" /></td>
                            <td>@taxa.NutsII</td>
                            <td>@taxa.NutsIII</td>
                            <td>@taxa.Concelho</td>
                            <td>@taxa.Taxa</td>
                            <td><button class="delete-btn">üóë</button></td>
                        </tr>
                    }
                </tbody>
            </table>
            <button class="add-taxa">+ ADICIONAR TAXA</button>
        </div>


        @if (showError)
        {
            <div class="erro">
                <p class="warning">Voc√™ s√≥ pode selecionar uma taxa por vez.</p>
            </div>
        }


        <div class="pagination">
            <span>1 de 2 p√°ginas (23 itens)</span>
            <select>
                <option>10</option>
                <option>20</option>
            </select> itens por p√°gina
            <button>&laquo;</button>
            <button>&raquo;</button>
        </div>
    </div>
</div>

@code {
    private List<TaxaItem> taxItems = new List<TaxaItem>
{
new TaxaItem { NutsII = "Norte", NutsIII = "Ave", Concelho = "Fafe", Taxa = "25%", Selected = false },
new TaxaItem { NutsII = "Norte", NutsIII = "√Årea Metropolitana do Porto", Concelho = "Matosinhos", Taxa = "75%",
Selected = false }
};

    private bool showError = false;

    private void ToggleCheckbox(TaxaItem taxa, bool? isChecked)
    {
        if (isChecked == true)
        {
            int selectedCount = taxItems.Count(t => t.Selected);


            if (selectedCount >= 1)
            {
                showError = true;
                taxa.Selected = false;
            }
            else
            {
                showError = false;
                taxa.Selected = true;
            }
        }
        else
        {
            taxa.Selected = false;
        }
    }

    public class TaxaItem
    {
        public string NutsII { get; set; }
        public string NutsIII { get; set; }
        public string Concelho { get; set; }
        public string Taxa { get; set; }
        public bool Selected { get; set; }
    }
}
